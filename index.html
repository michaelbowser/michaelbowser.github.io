<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
		<!-- leaflet created style sheet -->
        <link rel="stylesheet" href="css/leaflet.css" />
		<!-- style sheet generated from QGIS -->
        <link rel="stylesheet" type="text/css" href="css/qgis2web.css">
		<!-- style sheet for popup labels displaying text for project name -->
        <link rel="stylesheet" href="css/label.css" />
		<!-- style sheet for the point cluster symbology -->
        <link rel="stylesheet" href="css/MarkerCluster.css" />
        <link rel="stylesheet" href="css/MarkerCluster.Default.css" />
		<!-- style sheet for the geocoder toolbar -->
        <link rel="stylesheet" href="http://k4r573n.github.io/leaflet-control-osm-geocoder/Control.OSMGeocoder.css" />
		<!-- leaflet javascript api -->
        <script src="js/leaflet.js"></script>
		<!-- javascript for visualizing OSM data in this application -->
        <script src="js/OSMBuildings-Leaflet.js"></script>
		<!-- javascript for adding dynamic url based on zoom level and lat/long -->
        <script src="js/leaflet-hash.js"></script>
		<!-- javascript for adding labels to leaflet maps -->
        <script src="js/label.js"></script>
		<script src="js/FunctionButton.js"></script>
        <script src="js/Autolinker.min.js"></script>
		<!-- javascript for geocoder toolbar -->
        <script src="http://k4r573n.github.io/leaflet-control-osm-geocoder/Control.OSMGeocoder.js"></script>
		<!-- javascript for the marker clusters -->
        <script src="js/leaflet.markercluster.js"></script>
		<!-- javascript for left sidebar font, provided by google -->
		<link href='https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz:300' rel='stylesheet' type='text/css'>
		
        <style>		
		#map{
			position: fixed;
			top: 0;
			left: 20vw;
			bottom: 0;
			right: 0;
		}
		
        html, body {
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
        }
		
		#info{
			position: fixed;
			top: 0;
			left: 0;
			bottom: 0;
			width: 20vw;
			padding: 1em;
			background-color: #333333;
			font-family: 'Yanone Kaffeesatz', sans-serif;
			font-size: 13px;
		}
	  
		#para{
			position: fixed;
			top: 7em;
			left: 0;
			bottom: 0;
			width: 18vw;
			padding: 1em;
		}
	  
		.leaflet-bottom.leaflet-left{
			width: 100%;
		}
		
		.leaflet-control-container .leaflet-timeline-controls{
			box-sizing: border-box;
			width: 100%;
			margin: 0;
			margin-bottom: 15px;
		}
        </style>
		<!-- webpage title -->
        <title>WSSI Projects</title>
    </head>
	
    <body>
		<div id="info">
			<!-- text that is inserted into the left sidebar -->
			<h1><font color="white">Wetland Studies and Solutions</font></h1>
			<h3><font color="white">Previously Studied Projects</font></h3>
			<div id="para">
				<!-- text that is inserted into the left sidebar -->
				<h4><font color="grey">Lorem ipsum dolor sit amet, vidit nullam audire ex mea. An nostrum commune usu. 
				Tamquam admodum patrioque an eam, ut deseruisse consetetur usu. Et magna adipiscing eum, an sed quis 
				nonumes suavitate, vel ne utamur referrentur. In vim esse veri menandri, id eum senserit tractatos iudicabit. 
				Dicit efficiendi dissentiunt ad his, vel eu alia oporteat inciderint. Vidisse integre torquatos ex quo, cu 
				graeci mollis honestatis mel, per graeci scriptorem id. Cu his volumus omnesque vituperatoribus, in natum 
				debitis conceptam vix. Ex mollis aliquid pri, qui ut nonumy constituto incorrupte, quo ipsum saepe at. His 
				audiam eruditi intellegam ne. Usu odio solum posse et, no persius pertinax cum. Debet essent ponderum mei cu.
				Quo vero causae urbanitas ne, mel tempor vivendum ut. Est porro maiestatis id, et liber impetus eam. Te sed 
				sint graeci, qui ad lobortis temporibus. Ne mea erant mentitum temporibus, eloquentiam delicatissimi ut eam. 
				Ad euismod propriae appareat eos, ad alia latine duo. Est erat nulla saperet ad. Libris nusquam repudiare ea 
				his. Sea ut sale aliquid. Antiopam dissentiunt mel ei, no velit primis sea. An his erant ornatus, ea possim 
				iuvaret nec. Eius veri per ne. Te iuvaret dolorum qualisque cum, te veri illud ius. Tamquam tractatos salutatus 
				sed te.</font></h4>
				<!-- wssi logo inserted into the left sidebar -->
				<img src="logo.png" style="width:18vw;height:10vw;">
			</div>			
		</div>
        <!-- create the map container for the application  -->
		<div id="map"></div>
		<!-- add the javascript for the json containing the wssi project center points -->
        <script src="data/json_ProjectSites0.js"></script>
		
        <script>
		<!-- create popup when wssi sites centerpoint object is clicked -->
        var highlightLayer;
        function highlightFeature(e) {
            highlightLayer = e.target;
            highlightLayer.openPopup();
        }
        L.ImageOverlay.include({
            getBounds: function () {
                return this._bounds;
            }
        });
        var map = L.map('map', {
            zoomControl:true, maxZoom:16, minZoom:8
        })
        var hash = new L.Hash(map);
        var feature_group = new L.featureGroup([]);
        var bounds_group = new L.featureGroup([]);
        var raster_group = new L.LayerGroup([]);
        var basemap = L.tileLayer('http://{s}.www.toolserver.org/tiles/bw-mapnik/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
            maxZoom: 16
        });
        basemap.addTo(map);
        var initialOrder = new Array();
        var layerOrder = new Array();
        function stackLayers() {
            for (index = 0; index < initialOrder.length; index++) {
                map.removeLayer(initialOrder[index]);
                map.addLayer(initialOrder[index]);
            }
            if (bounds_group.getLayers().length) {
                map.fitBounds(bounds_group.getBounds());
            }
            map.setMaxBounds(map.getBounds());
        }
        function restackLayers() {
            for (index = 0; index < layerOrder.length; index++) {
                layerOrder[index].bringToFront();
            }
        }
        layerControl = L.control.layers({},{},{collapsed:false});
          function pop_ProjectSites0(feature, layer) {
            var popupContent = '<table><tr><th scope="row">Project Name</th><td>' + (feature.properties['PROJECT_NA'] !== null ? Autolinker.link(String(feature.properties['PROJECT_NA'])) : '') + '</td></tr></table>';
			layer.bindPopup(popupContent);
        }

        function doStyleProjectSites0() {
            return {
                radius: 5.0,
                fillColor: '#52ea8c',
                color: '#000000',
                weight: 1.0,
                opacity: 1.0,
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                fillOpacity: 1.0
            }
        }
        function doPointToLayerProjectSites0(feature, latlng) {
            return L.circleMarker(latlng, doStyleProjectSites0())
        }
        var json_ProjectSites0JSON = new L.geoJson(json_ProjectSites0, {
            onEachFeature: pop_ProjectSites0, 
            pointToLayer: doPointToLayerProjectSites0
            });
        var cluster_groupProjectSites0JSON = new L.MarkerClusterGroup({showCoverageOnHover: false});
        cluster_groupProjectSites0JSON.addLayer(json_ProjectSites0JSON);

        layerOrder[layerOrder.length] = cluster_groupProjectSites0JSON;

        bounds_group.addLayer(json_ProjectSites0JSON);
        initialOrder[initialOrder.length] = cluster_groupProjectSites0JSON;
        cluster_groupProjectSites0JSON.addTo(map);
        raster_group.addTo(map);
        feature_group.addTo(map);
        var osmGeocoder = new L.Control.OSMGeocoder({
            collapsed: false,
            position: 'topright',
            text:'Find Address',
        });
        osmGeocoder.addTo(map);
        var baseMaps = {'Black & White Basemap': basemap};
        L.control.layers(baseMaps,{'<img src="legend/ProjectSites0.png" /> WSSI Project Sites': cluster_groupProjectSites0JSON,},{collapsed:false}).addTo(map);
        L.control.scale({options: {position: 'bottomleft', maxWidth: 100, metric: true, imperial: false, updateWhenIdle: false}}).addTo(map);
        stackLayers();
        map.on('overlayadd', restackLayers);
		
		//create marker for the wssi gainesville office
		var gainesvilleOffice = L.marker([38.795643, -77.600902])
		map.on('zoomend ', function(e) {
			if (map.getZoom() < 16){map.removeLayer(gainesvilleOffice)}
				else if(map.getZoom() >= 16) {map.addLayer(gainesvilleOffice)}
		});
		
		//create marker for the wssi maryland office
		var marylandOffice = L.marker([39.093959, -76.634885])
		map.on('zoomend ', function(e) {
			if (map.getZoom() < 16){map.removeLayer(marylandOffice)}
				else if(map.getZoom() >= 16) {map.addLayer(marylandOffice)}
		});
		
		//create marker for the wssi roanoke office
		var roanokeOffice = L.marker([37.264396, -79.977120])
		map.on('zoomend ', function(e) {
			if (map.getZoom() < 16){map.removeLayer(roanokeOffice)}
				else if(map.getZoom() >= 16) {map.addLayer(roanokeOffice)}
		});
		
		//Add button to zoom to Gainesville Office
		var btn = L.functionButtons([{ content: '<b><font color="green">Gainesville Office</font></b>' }]);
			btn.on('clicked', function(data) {
			if( data.idx == 0 ) {
				map.setView([38.795544,-77.600838], 16);
					}
			});
			map.addControl(btn);
			
		//Add button to zoom to Maryland Office
		var btn = L.functionButtons([{ content: '<b><font color="green">Maryland Office</font></b>' }]);
			btn.on('clicked', function(data) {
			if( data.idx == 0 ) {
				map.setView([39.093901,-76.634860], 16);
					} 
			});
			map.addControl(btn);
			
		//Add button to zoom to Roanoke Office
		var btn = L.functionButtons([{ content: '<b><font color="green">Roanoke Office</font></b>' }]);
			btn.on('clicked', function(data) {
			if( data.idx == 0 ) {
				map.setView([37.264389, -79.977162], 16);
					} 
			});
			map.addControl(btn);	
        </script>

		
		
    </body>
</html>
